{"ast":null,"code":"import React,{useState}from'react';import{uploadFile}from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL;function UploadFile(){const[file,setFile]=useState(null);const[message,setMessage]=useState(\"\");const[uploading,setUploading]=useState(false);const[progress,setProgress]=useState(0);const[error,setError]=useState(\"\");const handleUpload=async e=>{e.preventDefault();setMessage(\"\");setError(\"\");setProgress(0);if(!file)return;setUploading(true);try{await uploadFileWithProgress(file,setProgress);setMessage(\"Upload successful!\");}catch(err){setError(\"Upload failed: \"+(err.message||err));}finally{setUploading(false);}};// Custom upload with progress\nconst uploadFileWithProgress=(file,onProgress)=>{return new Promise((resolve,reject)=>{const xhr=new XMLHttpRequest();const filename=encodeURIComponent(file.name);xhr.open('POST',\"\".concat(API_URL,\"/files?filename=\").concat(filename));xhr.upload.onprogress=event=>{if(event.lengthComputable){onProgress(Math.round(event.loaded/event.total*100));}};xhr.onload=()=>{if(xhr.status>=200&&xhr.status<300){resolve(xhr.response);}else{reject(new Error(xhr.statusText||'Upload failed'));}};xhr.onerror=()=>reject(new Error('Network error'));xhr.ontimeout=()=>reject(new Error('Request timed out'));const formData=new FormData();formData.append('file',file);xhr.send(formData);});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Upload File\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpload,children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:e=>setFile(e.target.files[0])}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:uploading,children:\"Upload\"})]}),uploading&&/*#__PURE__*/_jsxs(\"div\",{style:{margin:'1rem 0'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',background:'#e5e7eb',borderRadius:'8px',height:'16px'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:\"\".concat(progress,\"%\"),background:'#2563eb',height:'16px',borderRadius:'8px',transition:'width 0.2s'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginTop:4},children:[progress,\"%\"]})]}),message&&/*#__PURE__*/_jsx(\"div\",{style:{color:'green',marginTop:8},children:message}),error&&/*#__PURE__*/_jsx(\"div\",{style:{color:'red',marginTop:8},children:error})]});}export default UploadFile;","map":{"version":3,"names":["React","useState","uploadFile","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","UploadFile","file","setFile","message","setMessage","uploading","setUploading","progress","setProgress","error","setError","handleUpload","e","preventDefault","uploadFileWithProgress","err","onProgress","Promise","resolve","reject","xhr","XMLHttpRequest","filename","encodeURIComponent","name","open","concat","upload","onprogress","event","lengthComputable","Math","round","loaded","total","onload","status","response","Error","statusText","onerror","ontimeout","formData","FormData","append","send","children","onSubmit","type","onChange","target","files","disabled","style","margin","width","background","borderRadius","height","transition","textAlign","marginTop","color"],"sources":["/workspaces/codespaces-blank/ServerlessProject/frontend/src/pages/UploadFile.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { uploadFile } from '../api';\nconst API_URL = process.env.REACT_APP_API_URL;\n\nfunction UploadFile() {\n  const [file, setFile] = useState(null);\n  const [message, setMessage] = useState(\"\");\n  const [uploading, setUploading] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [error, setError] = useState(\"\");\n\n  const handleUpload = async (e) => {\n    e.preventDefault();\n    setMessage(\"\");\n    setError(\"\");\n    setProgress(0);\n    if (!file) return;\n    setUploading(true);\n    try {\n      await uploadFileWithProgress(file, setProgress);\n      setMessage(\"Upload successful!\");\n    } catch (err) {\n      setError(\"Upload failed: \" + (err.message || err));\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  // Custom upload with progress\n  const uploadFileWithProgress = (file, onProgress) => {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      const filename = encodeURIComponent(file.name);\n      xhr.open('POST', `${API_URL}/files?filename=${filename}`);\n      xhr.upload.onprogress = (event) => {\n        if (event.lengthComputable) {\n          onProgress(Math.round((event.loaded / event.total) * 100));\n        }\n      };\n      xhr.onload = () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          resolve(xhr.response);\n        } else {\n          reject(new Error(xhr.statusText || 'Upload failed'));\n        }\n      };\n      xhr.onerror = () => reject(new Error('Network error'));\n      xhr.ontimeout = () => reject(new Error('Request timed out'));\n      const formData = new FormData();\n      formData.append('file', file);\n      xhr.send(formData);\n    });\n  };\n\n  return (\n    <div>\n      <h2>Upload File</h2>\n      <form onSubmit={handleUpload}>\n        <input type=\"file\" onChange={e => setFile(e.target.files[0])} />\n        <button type=\"submit\" disabled={uploading}>Upload</button>\n      </form>\n      {uploading && (\n        <div style={{ margin: '1rem 0' }}>\n          <div style={{ width: '100%', background: '#e5e7eb', borderRadius: '8px', height: '16px' }}>\n            <div style={{ width: `${progress}%`, background: '#2563eb', height: '16px', borderRadius: '8px', transition: 'width 0.2s' }} />\n          </div>\n          <div style={{ textAlign: 'center', marginTop: 4 }}>{progress}%</div>\n        </div>\n      )}\n      {message && <div style={{ color: 'green', marginTop: 8 }}>{message}</div>}\n      {error && <div style={{ color: 'red', marginTop: 8 }}>{error}</div>}\n    </div>\n  );\n}\nexport default UploadFile;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}